(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{56:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(11),i=n.n(a),o=n(3),u=n(5),s=n(2),l=n.n(s),d=n(7),b=n(6),j=n(27),f=n(8),O=n.n(f),p="/api/blogs",h=null,v=function(){var e=Object(o.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,O.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g={getAll:function(){return O.a.get(p).then((function(e){return e.data}))},create:v,update:function(e){return O.a.put("".concat(p,"/").concat(e.id),e).then((function(e){return e.data}))},setToken:function(e){h="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:h}};return O.a.delete("".concat(p,"/").concat(e),t).then((function(e){return e.data}))}},x=function(e){return function(){var t=Object(o.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.create(e);case 2:r=t.sent,n({type:"CREATE_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("blogReducer",t),t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return[].concat(Object(j.a)(e),[t.data]);case"LIKE_BLOG":var n=t.data,r=e.find((function(e){return e.id===n})),c=Object(d.a)(Object(d.a)({},r),{},{likes:r.likes+1});return e.map((function(e){return e.id===n?c:e}));case"REMOVE_BLOG":return e.filter((function(e){return e!==t.data}));default:return e}},w=n(1),y=function(e){var t=e.blog,n=e.own,c=Object(r.useState)(!1),a=Object(u.a)(c,2),i=a[0],s=a[1],j=Object(b.c)(),f=function(e){var t=Object(d.a)(Object(d.a)({},e),{},{likes:e.likes+1,user:e.user.id});j(function(e){return function(){var t=Object(o.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.update(e);case 2:n({type:"LIKE_BLOG",data:e.id});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},O=function(e){var t;window.confirm("Remove blog ".concat(e.title," by ").concat(e.author))&&j((t=e.id,function(){var e=Object(o.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.remove(t);case 2:n({type:"REMOVE_BLOG",data:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},p=i?"hide":"view";return Object(w.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{children:t.title})," by ",t.author," ",Object(w.jsx)("button",{onClick:function(){return s(!i)},children:p})]}),i&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:t.url}),Object(w.jsxs)("div",{children:["likes ",t.likes,Object(w.jsx)("button",{onClick:function(){return f(t)},children:"like"})]}),Object(w.jsx)("div",{children:t.user.name}),n&&Object(w.jsx)("button",{onClick:function(){return O(t)},children:"remove"})]})]})},k=Object(b.b)((function(e){return{notification:e.notification}}))((function(e){if(!e.notification)return null;var t={borderStyle:"solid",borderRadius:5,padding:10,color:"success"===e.notification.color?"green":"red",background:"lightgrey"};return Object(w.jsx)("div",{style:t,children:e.notification.message})})),S=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(u.a)(n,2),a=c[0],i=c[1],o={display:a?"none":""},s={display:a?"":"none"},l=function(){i(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{style:o,children:Object(w.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(w.jsxs)("div",{style:s,className:"togglableContent",children:[e.children,Object(w.jsx)("button",{onClick:l,children:"cancel"})]})]})}));S.displayName="Togglable";var I,T=S,E=function(e){var t=Object(r.useState)(""),n=Object(u.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),s=o[0],l=o[1],d=Object(r.useState)(""),b=Object(u.a)(d,2),j=b[0],f=b[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:"create new"}),Object(w.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.createBlog({title:c,author:s,url:j}),a(""),l(""),f("")},children:[Object(w.jsxs)("div",{children:["author",Object(w.jsx)("input",{id:"author",value:s,onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(w.jsxs)("div",{children:["title",Object(w.jsx)("input",{id:"title",value:c,onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(w.jsxs)("div",{children:["url",Object(w.jsx)("input",{id:"url",value:j,onChange:function(e){var t=e.target;return f(t.value)}})]}),Object(w.jsx)("button",{id:"create",children:"create"})]})]})},C=function(){var e=Object(o.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B={login:C},L=function(e,t,n){return function(){var r=Object(o.a)(l.a.mark((function r(c){return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c({type:"SHOW_NOTI",data:{message:e,color:n}}),clearTimeout(I),I=setTimeout((function(){c({type:"HIDE_NOTI"})}),t);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_NOTI":return t.data;case"HIDE_NOTI":return null;default:return e}},_=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),s=Object(u.a)(i,2),d=s[0],j=s[1],f=Object(r.useState)(""),O=Object(u.a)(f,2),p=O[0],h=O[1],v=c.a.createRef(),m=Object(b.c)(),S=Object(b.d)((function(e){return e.blogs}));Object(r.useEffect)((function(){m(function(){var e=Object(o.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[m]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteappUser");if(e){var t=JSON.parse(e);a(t),g.setToken(t.token)}}),[]);var I=function(){var e=Object(o.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,B.login({username:d,password:p});case 4:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),g.setToken(n.token),j(""),h(""),a(n),m(L("".concat(n.name," welcome back!"),5e3,"success")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),m(L("wrong username/password",5e3,"error"));case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{v.current.toggleVisibility(),m(x(t)),m(L("a new blog '".concat(t.title,"' by ").concat(t.author," added!"),5e3,"success"))}catch(n){console.log(n),m(L("something went wrong",5e3,"error"))}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!n)return Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:"login to application"}),Object(w.jsx)(k,{}),Object(w.jsxs)("form",{onSubmit:I,children:[Object(w.jsxs)("div",{children:["username",Object(w.jsx)("input",{id:"username",value:d,onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(w.jsxs)("div",{children:["password",Object(w.jsx)("input",{id:"password",value:p,onChange:function(e){var t=e.target;return h(t.value)}})]}),Object(w.jsx)("button",{id:"login",children:"login"})]})]});return Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:"blogs"}),Object(w.jsx)(k,{}),Object(w.jsxs)("p",{children:[n.name," logged in ",Object(w.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedNoteappUser"),a(null)},children:"logout"})]}),Object(w.jsx)(T,{buttonLabel:"create new blog",ref:v,children:Object(w.jsx)(E,{createBlog:C})}),S.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(w.jsx)(y,{blog:e,own:n.username===e.user.username},e.id)}))]})},R=n(10),G=n(26),A=n(25),D=Object(R.combineReducers)({notification:N,blogs:m}),H=Object(R.createStore)(D,Object(A.composeWithDevTools)(Object(R.applyMiddleware)(G.a)));i.a.render(Object(w.jsx)(b.a,{store:H,children:Object(w.jsx)(_,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.0dc1b261.chunk.js.map